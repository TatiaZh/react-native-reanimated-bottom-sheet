{"version":3,"sources":["index.tsx"],"names":["React","Dimensions","Platform","View","Keyboard","Animated","PanGestureHandler","TapGestureHandler","State","GestureState","height","screenHeight","get","P","android","ios","OS","magic","damping","mass","stiffness","overshootClamping","restSpeedThreshold","restDisplacementThreshold","deceleration","bouncyFactor","velocityFactor","toss","coefForTranslatingVelocities","set","cond","onChange","block","eq","greaterOrEq","sqrt","not","defined","max","add","and","Value","spring","or","divide","greaterThan","sub","event","diff","multiply","clockRunning","startClock","stopClock","decay","Clock","lessThan","call","lessOrEq","neq","runDecay","clock","value","velocity","wasStartedFromBegin","state","finished","position","time","config","withPreservingAdditiveOffset","drag","prev","valWithPreservedOffset","BEGAN","withDecaying","decayClock","prevent","valDecayed","offset","END","ACTIVE","BottomSheetBehavior","Component","constructor","props","nativeEvent","translationY","dragMasterY","panMasterState","velocityY","masterVelocity","enabledInnerScrolling","dragY","panState","tapState","index","enabledImperativeSnapping","manuallySetValue","setValue","snapPoints","propsToNewIndices","isManuallySetValue","layout","heightOfHeader","heightOfHeaderAnimated","setState","requestAnimationFrame","keyboardOpen","heightOfContent","initSnap","panRef","innerGestureHandlerRefs","master","tapRef","getDerivedStateFromProps","undefined","init","middlesOfSnapPoints","i","length","tuple","push","masterOffseted","tossForMaster","springConfig","hasOwnProperty","destinationPoint","positive","currentSnapPoint","snapPoint","enabledBottomClamp","clampingValue","masterClock","prevMasterDrag","wasRun","translateMaster","CANCELLED","FAILED","runSpring","preventDecaying","masterClockForOverscroll","overdragResistanceFactor","Y","withEnhancedLimits","componentDidMount","keyboardDidShowListener","addListener","select","endCoordinates","keyboardDidHideListener","componentDidUpdate","_prevProps","prevState","dest","isManuallySet","valueToBeZeroed","toValue","val","wasRunMaster","min","limitedVal","diffPres","flagWasRunSpring","justEndedIfEnded","wasEndedMasterAfterInner","prevMaster","rev","sortedPropsSnapPoints","map","s","ind","renumber","Error","sort","a","b","forEach","__initialized","p","initialSnap","enabledBottomInitialAnimation","render","borderRadius","width","handleFullHeader","zIndex","opacity","transform","translateY","enabledGestureInteraction","enabledHeaderGestureInteraction","handleMasterPan","simultaneousHandlers","handleLayoutHeader","renderHeader","overflow","borderTopLeftRadius","borderTopRightRadius","enabledContentGestureInteraction","handlePan","enabledContentTapInteraction","handleTap","handleLayoutContent","renderContent","callbackNode","onOpenStart","onCloseEnd","callbackThreshold","onOpenStartValue","onCloseEndValue","onOpenEnd","onCloseStart","onOpenEndValue","onCloseStartValue","contentPosition","headerPosition","createRef","str","Number","split"],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport { Dimensions, Platform, View, LayoutChangeEvent, Keyboard } from 'react-native'\nimport Animated from 'react-native-reanimated'\nimport {\n  PanGestureHandler,\n  TapGestureHandler,\n  State as GestureState,\n} from 'react-native-gesture-handler'\n\ntype Props = {\n  /**\n   * Points for snapping of bottom sheet component. They define distance from bottom of the screen.\n   * Might be number or percent (as string e.g. '20%') for points or percents of screen height from bottom.\n   */\n  snapPoints: (number | string)[]\n\n  /**\n   * Determines initial snap point of bottom sheet. Defaults to 0.\n   */\n  initialSnap: number\n\n  /**\n   * Method for rendering scrollable content of bottom sheet.\n   */\n  renderContent?: () => React.ReactNode\n\n  /**\n   * Method for rendering non-scrollable header of bottom sheet.\n   */\n  renderHeader?: () => React.ReactNode\n\n  /**\n   * Defines if bottom sheet could be scrollable by gesture. Defaults to true.\n   */\n  enabledGestureInteraction?: boolean\n  enabledHeaderGestureInteraction?: boolean\n  enabledContentGestureInteraction?: boolean\n\n  /**\n   * Defines if bottom sheet content responds to taps. Defaults to true.\n   */\n  enabledContentTapInteraction?: boolean\n\n  /**\n   * When true, clamp bottom position to first snapPoint.\n   */\n  enabledBottomClamp?: boolean\n\n  /**\n   * When true, sheet will grows up from bottom to initial snapPoint.\n   */\n  enabledBottomInitialAnimation?: boolean\n\n  /**\n   * If false blocks snapping using snapTo method. Defaults to true.\n   */\n  enabledManualSnapping?: boolean\n\n  /**\n   * Defines whether it's possible to scroll inner content of bottom sheet. Defaults to true.\n   */\n  enabledInnerScrolling?: boolean\n\n  /**\n   * Reanimated node which holds position of bottom sheet, where 1 it the highest snap point and 0 is the lowest.\n   */\n  callbackNode?: Animated.Value<number>\n\n  /**\n   * Reanimated node which holds position of bottom sheet;s content (in dp).\n   */\n  contentPosition?: Animated.Value<number>\n\n  /**\n   * Reanimated node which holds position of bottom sheet's header (in dp).\n   */\n  headerPosition?: Animated.Value<number>\n\n  /**\n   * Defines how violently sheet has to stopped while overdragging. 0 means no overdrag. Defaults to 0.\n   */\n  overdragResistanceFactor: number\n\n  /**\n   * Array of Refs passed to gesture handlers for simultaneous event handling\n   */\n  simultaneousHandlers?: Array<React.RefObject<any>> | React.RefObject<any>\n\n  /**\n   * Overrides config for spring animation\n   */\n  springConfig: {\n    damping?: number\n    mass?: number\n    stiffness?: number\n    restSpeedThreshold?: number\n    restDisplacementThreshold?: number\n    toss?: number\n  }\n\n  /**\n   * Refs for gesture handlers used for building bottomsheet\n   */\n  innerGestureHandlerRefs: [\n    React.RefObject<PanGestureHandler>,\n    React.RefObject<PanGestureHandler>,\n    React.RefObject<TapGestureHandler>\n  ]\n\n  enabledImperativeSnapping?: boolean\n\n  onOpenStart?: () => void\n  onOpenEnd?: () => void\n  onCloseStart?: () => void\n  onCloseEnd?: () => void\n  callbackThreshold?: number\n  borderRadius?: number\n}\n\ntype State = {\n  snapPoints: Animated.Value<number>[]\n  init: any\n  initSnap: number\n  propsToNewIndices: { [key: string]: number }\n  heightOfContent: Animated.Value<number>\n  heightOfHeader: number\n  heightOfHeaderAnimated: Animated.Value<number>\n  keyboardOpen: boolean\n}\n\nconst { height: screenHeight } = Dimensions.get('window')\n\nconst P = <T extends any>(android: T, ios: T): T =>\n  Platform.OS === 'ios' ? ios : android\n\nconst magic = {\n  damping: 50,\n  mass: 0.3,\n  stiffness: 121.6,\n  overshootClamping: true,\n  restSpeedThreshold: 0.3,\n  restDisplacementThreshold: 0.3,\n  deceleration: 0.999,\n  bouncyFactor: 1,\n  velocityFactor: P(1, 0.8),\n  toss: 0.4,\n  coefForTranslatingVelocities: 5,\n}\n\nconst {\n  damping,\n  mass,\n  stiffness,\n  overshootClamping,\n  restSpeedThreshold,\n  restDisplacementThreshold,\n  deceleration,\n  velocityFactor,\n  toss,\n} = magic\n\nconst {\n  set,\n  cond,\n  onChange,\n  block,\n  eq,\n  greaterOrEq,\n  sqrt,\n  not,\n  defined,\n  max,\n  add,\n  and,\n  Value,\n  spring,\n  or,\n  divide,\n  greaterThan,\n  sub,\n  event,\n  diff,\n  multiply,\n  clockRunning,\n  startClock,\n  stopClock,\n  decay,\n  Clock,\n  lessThan,\n  call,\n  lessOrEq,\n  neq,\n} = Animated\n\nfunction runDecay(\n  clock: Animated.Clock,\n  value: Animated.Node<number>,\n  velocity: Animated.Node<number>,\n  wasStartedFromBegin: Animated.Value<number>\n) {\n  const state = {\n    finished: new Value(0),\n    velocity: new Value(0),\n    position: new Value(0),\n    time: new Value(0),\n  }\n\n  const config = { deceleration }\n\n  return [\n    cond(clockRunning(clock), 0, [\n      cond(wasStartedFromBegin, 0, [\n        set(wasStartedFromBegin, 1),\n        set(state.finished, 0),\n        set(state.velocity, multiply(velocity, velocityFactor)),\n        set(state.position, value),\n        set(state.time, 0),\n        startClock(clock),\n      ]),\n    ]),\n    cond(clockRunning(clock), decay(clock, state, config)),\n    cond(state.finished, stopClock(clock)),\n    state.position,\n  ]\n}\n\nfunction withPreservingAdditiveOffset(\n  drag: Animated.Node<number>,\n  state: Animated.Node<number>\n) {\n  const prev = new Value(0)\n  const valWithPreservedOffset = new Value(0)\n  return block([\n    cond(\n      eq(state, GestureState.BEGAN),\n      [set(prev, 0)],\n      [\n        set(\n          valWithPreservedOffset,\n          add(valWithPreservedOffset, sub(drag, prev))\n        ),\n        set(prev, drag),\n      ]\n    ),\n    valWithPreservedOffset,\n  ])\n}\n\nfunction withDecaying(\n  drag: Animated.Node<number>,\n  state: Animated.Node<number>,\n  decayClock: Animated.Clock,\n  velocity: Animated.Node<number>,\n  prevent: Animated.Value<number>\n) {\n  const valDecayed = new Value(0)\n  const offset = new Value(0)\n  // since there might be moar than one clock\n  const wasStartedFromBegin = new Value(0)\n  return block([\n    cond(\n      eq(state, GestureState.END),\n      [\n        cond(\n          prevent,\n          stopClock(decayClock),\n          set(\n            valDecayed,\n            runDecay(\n              decayClock,\n              add(drag, offset),\n              velocity,\n              wasStartedFromBegin\n            )\n          )\n        ),\n      ],\n      [\n        stopClock(decayClock),\n        cond(eq(state, GestureState.BEGAN), set(prevent, 0)),\n        cond(\n          or(eq(state, GestureState.BEGAN), eq(state, GestureState.ACTIVE)),\n          set(wasStartedFromBegin, 0)\n        ),\n        cond(eq(state, GestureState.BEGAN), [\n          set(offset, sub(valDecayed, drag)),\n        ]),\n        set(valDecayed, add(drag, offset)),\n      ]\n    ),\n    valDecayed,\n  ])\n}\n\nexport default class BottomSheetBehavior extends React.Component<Props, State> {\n  static defaultProps = {\n    overdragResistanceFactor: 0,\n    initialSnap: 0,\n    enabledImperativeSnapping: true,\n    enabledGestureInteraction: true,\n    enabledBottomClamp: false,\n    enabledBottomInitialAnimation: false,\n    enabledHeaderGestureInteraction: true,\n    enabledContentGestureInteraction: true,\n    enabledContentTapInteraction: true,\n    enabledInnerScrolling: true,\n    springConfig: {},\n    innerGestureHandlerRefs: [\n      React.createRef(),\n      React.createRef(),\n      React.createRef(),\n    ],\n    callbackThreshold: 0.01,\n  }\n\n  private decayClock = new Clock()\n  private panState = new Value(0)\n  private tapState = new Value(0)\n  private velocity = new Value(0)\n  private panMasterState: Animated.Value<number> = new Value(GestureState.END)\n  private masterVelocity = new Value(0)\n  private isManuallySetValue: Animated.Value<number> = new Value(0)\n  private manuallySetValue = new Value(0)\n  private masterClockForOverscroll = new Clock()\n  private preventDecaying: Animated.Value<number> = new Value(0)\n  private dragMasterY = new Value(0)\n  private dragY = new Value(0)\n  private translateMaster: Animated.Node<number>\n  private panRef: React.RefObject<PanGestureHandler>\n  private master: React.RefObject<PanGestureHandler>\n  private tapRef: React.RefObject<TapGestureHandler>\n  private snapPoint: Animated.Node<number>\n  private Y: Animated.Node<number>\n  private clampingValue: Animated.Value<number> = new Value(0)\n  private onOpenStartValue: Animated.Value<number> = new Value(0)\n  private onOpenEndValue: Animated.Value<number> = new Value(0)\n  private onCloseStartValue: Animated.Value<number> = new Value(1)\n  private onCloseEndValue: Animated.Value<number> = new Value(0)\n\n  constructor(props: Props) {\n    super(props)\n\n    this.panRef = props.innerGestureHandlerRefs[0]\n    this.master = props.innerGestureHandlerRefs[1]\n    this.tapRef = props.innerGestureHandlerRefs[2]\n    this.state = BottomSheetBehavior.getDerivedStateFromProps(props, undefined)\n\n    const { snapPoints, init } = this.state\n    const middlesOfSnapPoints: [\n      Animated.Node<number>,\n      Animated.Node<number>\n    ][] = []\n\n    for (let i = 1; i < snapPoints.length; i++) {\n      const tuple: [Animated.Node<number>, Animated.Node<number>] = [\n        add(snapPoints[i - 1], 10),\n        sub(snapPoints[i], 25),\n      ]\n      middlesOfSnapPoints.push(tuple)\n    }\n\n    const masterOffseted = new Value(init)\n    // destination point is a approximation of movement if finger released\n    const tossForMaster =\n      props.springConfig.hasOwnProperty('toss') &&\n      props.springConfig.toss != undefined\n        ? props.springConfig.toss\n        : toss\n    const destinationPoint = add(\n      masterOffseted,\n      multiply(tossForMaster, this.masterVelocity)\n    )\n\n    const positive = greaterOrEq(\n      multiply(tossForMaster, this.masterVelocity),\n      0\n    )\n    // method for generating condition for finding the nearest snap point\n    const currentSnapPoint = (i = 0): Animated.Node<number> =>\n      i + 1 === snapPoints.length\n        ? snapPoints[i]\n        : cond(\n            positive,\n            cond(\n              greaterThan(destinationPoint, middlesOfSnapPoints[i][0]),\n              cond(\n                lessThan(destinationPoint, middlesOfSnapPoints[i][1]),\n                snapPoints[i + 1],\n                currentSnapPoint(i + 1)\n              ),\n              snapPoints[i]\n            ),\n            cond(\n              greaterThan(destinationPoint, middlesOfSnapPoints[i][1]),\n              cond(\n                lessThan(destinationPoint, middlesOfSnapPoints[i][0]),\n                snapPoints[i + 1],\n                currentSnapPoint(i + 1)\n              ),\n              snapPoints[i]\n            )\n          )\n    // current snap point desired\n    this.snapPoint = currentSnapPoint()\n\n    if (props.enabledBottomClamp) {\n      this.clampingValue.setValue(snapPoints[snapPoints.length - 1])\n    }\n\n    const masterClock = new Clock()\n    const prevMasterDrag = new Value(0)\n    const wasRun: Animated.Value<number> = new Value(0)\n    this.translateMaster = block([\n      cond(\n        or(\n          eq(this.panMasterState, GestureState.END),\n          eq(this.panMasterState, GestureState.CANCELLED),\n          eq(this.panMasterState, GestureState.FAILED)\n        ),\n        [\n          set(prevMasterDrag, 0),\n          cond(\n            or(clockRunning(masterClock), not(wasRun), this.isManuallySetValue),\n            [\n              cond(this.isManuallySetValue, stopClock(masterClock)),\n              set(\n                masterOffseted,\n                this.runSpring(\n                  masterClock,\n                  masterOffseted,\n                  this.masterVelocity,\n                  cond(\n                    this.isManuallySetValue,\n                    this.manuallySetValue,\n                    this.snapPoint\n                  ),\n                  wasRun,\n                  this.isManuallySetValue,\n                  this.masterVelocity\n                )\n              ),\n              set(this.isManuallySetValue, 0),\n            ]\n          ),\n        ],\n        [\n          stopClock(masterClock),\n          set(this.preventDecaying, 1),\n          set(\n            masterOffseted,\n            add(masterOffseted, sub(this.dragMasterY, prevMasterDrag))\n          ),\n          set(prevMasterDrag, this.dragMasterY),\n          set(wasRun, 0), // not sure about this move for cond-began\n          cond(\n            eq(this.panMasterState, GestureState.BEGAN),\n            stopClock(this.masterClockForOverscroll)\n          ),\n        ]\n      ),\n      cond(\n        greaterThan(masterOffseted, snapPoints[0]),\n        cond(\n          and(\n            props.enabledBottomClamp ? 1 : 0,\n            greaterThan(masterOffseted, this.clampingValue)\n          ),\n          this.clampingValue,\n          masterOffseted\n        ),\n        max(\n          multiply(\n            sub(\n              snapPoints[0],\n              sqrt(add(1, sub(snapPoints[0], masterOffseted)))\n            ),\n            !props.enabledInnerScrolling ? props.overdragResistanceFactor : 0\n          ),\n          masterOffseted\n        )\n      ),\n    ])\n\n    this.Y = this.withEnhancedLimits(\n      withDecaying(\n        withPreservingAdditiveOffset(this.dragY, this.panState),\n        this.panState,\n        this.decayClock,\n        this.velocity,\n        this.preventDecaying\n      ),\n      masterOffseted\n    )\n  }\n          \t\n  componentDidMount(){\n    this.keyboardDidShowListener = Keyboard.addListener(\n      Platform.select({\n        ios: 'keyboardWillShow',\n        android: 'keyboardDidShow',\n      }),\n      ({ endCoordinates }) => {\n        this.setState(\n          {\n            keyboardOpen: true\n          }\n        );\n      }\n    );\n    this.keyboardDidHideListener = Keyboard.addListener(\n      Platform.select({\n        ios: 'keyboardWillHide',\n        android: 'keyboardDidHide',\n      }),\n      () => {\n        this.setState({ keyboardOpen: false})\n      }\n    );\n  }\n\n  componentDidUpdate(_prevProps: Props, prevState: State) {\n    const { snapPoints } = this.state\n    if (this.props.enabledBottomClamp && snapPoints !== prevState.snapPoints) {\n      this.clampingValue.setValue(snapPoints[snapPoints.length - 1])\n    }\n  }\n\n  private runSpring(\n    clock: Animated.Clock,\n    value: Animated.Value<number>,\n    velocity: Animated.Node<number>,\n    dest: Animated.Node<number>,\n    wasRun: Animated.Value<number>,\n    isManuallySet: Animated.Node<number> | number,\n    valueToBeZeroed: Animated.Value<number>\n  ) {\n    const state = {\n      finished: new Value(0),\n      velocity: new Value(0),\n      position: new Value(0),\n      time: new Value(0),\n    }\n\n    const config = {\n      damping,\n      mass,\n      stiffness,\n      overshootClamping,\n      restSpeedThreshold,\n      restDisplacementThreshold,\n      toValue: new Value(0),\n      ...this.props.springConfig,\n    }\n\n    return [\n      cond(clockRunning(clock), 0, [\n        set(state.finished, 0),\n        set(state.velocity, velocity),\n        set(state.position, value),\n        set(config.toValue, dest),\n        cond(and(wasRun, not(isManuallySet)), 0, startClock(clock)),\n        cond(defined(wasRun), set(wasRun, 1)),\n      ]),\n      spring(clock, state, config),\n      cond(state.finished, [stopClock(clock), set(valueToBeZeroed, 0)]),\n      state.position,\n    ]\n  }\n\n  private handleMasterPan = event([\n    {\n      nativeEvent: {\n        translationY: this.dragMasterY,\n        state: this.panMasterState,\n        velocityY: this.masterVelocity,\n      },\n    },\n  ])\n\n  private handlePan = event([\n    {\n      nativeEvent: {\n        translationY: this.props.enabledInnerScrolling\n          ? this.dragY\n          : this.dragMasterY,\n        state: this.props.enabledInnerScrolling\n          ? this.panState\n          : this.panMasterState,\n        velocityY: this.props.enabledInnerScrolling\n          ? this.velocity\n          : this.masterVelocity,\n      },\n    },\n  ])\n\n  private handleTap = event([{ nativeEvent: { state: this.tapState } }])\n\n  private withEnhancedLimits(\n    val: Animated.Node<number>,\n    masterOffseted: Animated.Value<number>\n  ) {\n    const wasRunMaster = new Value(0)\n    const min = multiply(\n      -1,\n      add(this.state.heightOfContent, this.state.heightOfHeaderAnimated)\n    )\n    const prev = new Value(0)\n    const limitedVal = new Value(0)\n    const diffPres = new Value(0)\n    const flagWasRunSpring = new Value(0)\n    const justEndedIfEnded: Animated.Value<number> = new Value(1)\n    const wasEndedMasterAfterInner: Animated.Value<number> = new Value(1)\n    const prevMaster = new Value(1)\n    const prevState = new Value(0)\n    const rev = new Value(0)\n\n    return block([\n      set(rev, limitedVal),\n      cond(\n        or(\n          eq(this.panState, GestureState.BEGAN),\n          and(\n            eq(this.panState, GestureState.ACTIVE),\n            eq(prevState, GestureState.END)\n          )\n        ),\n        [\n          set(prev, val),\n          set(flagWasRunSpring, 0),\n          stopClock(this.masterClockForOverscroll),\n          set(wasRunMaster, 0),\n        ],\n        [\n          set(limitedVal, add(limitedVal, sub(val, prev))),\n          cond(lessThan(limitedVal, min), set(limitedVal, min)),\n        ]\n      ),\n      set(prevState, this.panState), // on iOS sometimes BEGAN event does not trigger\n      set(diffPres, sub(prev, val)),\n      set(prev, val),\n      cond(\n        or(greaterOrEq(limitedVal, 0), greaterThan(masterOffseted, 0)),\n        [\n          cond(\n            eq(this.panState, GestureState.ACTIVE),\n            set(masterOffseted, sub(masterOffseted, diffPres))\n          ),\n          cond(greaterThan(masterOffseted, 0), [set(limitedVal, 0)]),\n          cond(\n            not(eq(this.panState, GestureState.END)),\n            set(justEndedIfEnded, 1)\n          ),\n          cond(\n            or(\n              eq(this.panState, GestureState.ACTIVE),\n              eq(this.panMasterState, GestureState.ACTIVE)\n            ),\n            set(wasEndedMasterAfterInner, 0)\n          ),\n          cond(\n            and(\n              eq(prevMaster, GestureState.ACTIVE),\n              eq(this.panMasterState, GestureState.END),\n              eq(this.panState, GestureState.END)\n            ),\n            set(wasEndedMasterAfterInner, 1)\n          ),\n          set(prevMaster, this.panMasterState),\n          cond(\n            and(\n              eq(this.panState, GestureState.END),\n              not(wasEndedMasterAfterInner),\n              not(eq(this.panMasterState, GestureState.ACTIVE)),\n              not(eq(this.panMasterState, GestureState.BEGAN)),\n              or(clockRunning(this.masterClockForOverscroll), not(wasRunMaster))\n            ),\n            [\n              // cond(justEndedIfEnded, set(this.masterVelocity, diff(val))),\n              set(\n                this.masterVelocity,\n                cond(justEndedIfEnded, diff(val), this.velocity)\n              ),\n              set(\n                masterOffseted,\n                this.runSpring(\n                  this.masterClockForOverscroll,\n                  masterOffseted,\n                  diff(val),\n                  this.snapPoint,\n                  wasRunMaster,\n                  0,\n                  this.masterVelocity\n                )\n              ),\n              set(this.masterVelocity, 0),\n            ]\n          ),\n          //   cond(eq(this.panState, State.END), set(wasEndedMasterAfterInner, 0)),\n          cond(eq(this.panState, GestureState.END), set(justEndedIfEnded, 0)),\n          set(this.preventDecaying, 1),\n          0,\n        ],\n        [set(this.preventDecaying, 0), limitedVal]\n      ),\n    ])\n  }\n\n  snapTo = (index: number) => {\n    if (!this.props.enabledImperativeSnapping) {\n      return\n    }\n    this.manuallySetValue.setValue(\n      // @ts-ignore\n      this.state.snapPoints[this.state.propsToNewIndices[index]]\n    )\n    this.isManuallySetValue.setValue(1)\n  }\n\n  private height: Animated.Value<number> = new Value(0)\n\n  private handleLayoutHeader = ({\n    nativeEvent: {\n      layout: { height: heightOfHeader },\n    },\n  }: LayoutChangeEvent) => {\n    this.state.heightOfHeaderAnimated.setValue(heightOfHeader)\n    this.setState({ heightOfHeader })\n  }\n\n  private handleFullHeader = ({\n    nativeEvent: {\n      layout: { height },\n    },\n  }: LayoutChangeEvent) =>\n    requestAnimationFrame(() => !this.state.keyboardOpen && this.height.setValue(height))\n\n  private handleLayoutContent = ({\n    nativeEvent: {\n      layout: { height },\n    },\n  }: LayoutChangeEvent) =>\n    this.state.heightOfContent.setValue(height - this.state.initSnap)\n\n  static renumber = (str: string) =>\n    (Number(str.split('%')[0]) * screenHeight) / 100\n\n  static getDerivedStateFromProps(\n    props: Props,\n    state: State | undefined\n  ): State {\n    let snapPoints\n    const sortedPropsSnapPoints: Array<{\n      val: number\n      ind: number\n    }> = props.snapPoints\n      .map(\n        (\n          s: number | string,\n          i: number\n        ): {\n          val: number\n          ind: number\n        } => {\n          if (typeof s === 'number') {\n            return { val: s, ind: i }\n          } else if (typeof s === 'string') {\n            return { val: BottomSheetBehavior.renumber(s), ind: i }\n          }\n\n          throw new Error(`Invalid type for value ${s}: ${typeof s}`)\n        }\n      )\n      .sort(({ val: a }, { val: b }) => b - a)\n    if (state && state.snapPoints) {\n      state.snapPoints.forEach(\n        (s, i) =>\n          // @ts-ignore\n          s.__initialized &&\n          s.setValue(\n            sortedPropsSnapPoints[0].val - sortedPropsSnapPoints[i].val\n          )\n      )\n      snapPoints = state.snapPoints\n    } else {\n      snapPoints = sortedPropsSnapPoints.map(\n        p => new Value(sortedPropsSnapPoints[0].val - p.val)\n      )\n    }\n\n    const propsToNewIndices: { [key: string]: number } = {}\n    sortedPropsSnapPoints.forEach(({ ind }, i) => (propsToNewIndices[ind] = i))\n\n    const { initialSnap } = props\n\n    let init =\n      sortedPropsSnapPoints[0].val -\n      sortedPropsSnapPoints[propsToNewIndices[initialSnap]].val\n\n    if (props.enabledBottomInitialAnimation) {\n      init =\n        sortedPropsSnapPoints[\n          sortedPropsSnapPoints.length - 1 - propsToNewIndices[initialSnap]\n        ].val\n    }\n\n    return {\n      init,\n      propsToNewIndices,\n      heightOfHeaderAnimated:\n        (state && state.heightOfHeaderAnimated) || new Value(0),\n      heightOfContent: (state && state.heightOfContent) || new Value(0),\n      initSnap: sortedPropsSnapPoints[0].val,\n      snapPoints,\n      heightOfHeader: (state && state.heightOfHeader) || 0,\n    }\n  }\n\n  render() {\n    const { borderRadius } = this.props\n    return (\n      <React.Fragment>\n        <Animated.View\n          style={{\n            height: '100%',\n            width: 0,\n            position: 'absolute',\n          }}\n          onLayout={this.handleFullHeader}\n        />\n        <Animated.View\n          style={{\n            width: '100%',\n            position: 'absolute',\n            zIndex: 100,\n            opacity: cond(this.height, 1, 0),\n            transform: [\n              {\n                translateY: this.translateMaster,\n              },\n              {\n                translateY: sub(this.height, this.state.initSnap) as any,\n              },\n            ],\n          }}\n        >\n          <PanGestureHandler\n            enabled={\n              this.props.enabledGestureInteraction &&\n              this.props.enabledHeaderGestureInteraction\n            }\n            ref={this.master}\n            waitFor={this.panRef}\n            onGestureEvent={this.handleMasterPan}\n            onHandlerStateChange={this.handleMasterPan}\n            simultaneousHandlers={this.props.simultaneousHandlers}\n          >\n            <Animated.View\n              style={{\n                zIndex: 101,\n              }}\n              onLayout={this.handleLayoutHeader}\n            >\n              {this.props.renderHeader && this.props.renderHeader()}\n            </Animated.View>\n          </PanGestureHandler>\n          <View\n            style={\n              this.props.enabledInnerScrolling && {\n                height: this.state.initSnap - this.state.heightOfHeader,\n                overflow: 'hidden',\n                borderTopLeftRadius: borderRadius,\n                borderTopRightRadius: borderRadius,\n              }\n            }\n          >\n            <PanGestureHandler\n              enabled={\n                this.props.enabledGestureInteraction &&\n                this.props.enabledContentGestureInteraction\n              }\n              waitFor={this.master}\n              ref={this.panRef}\n              onGestureEvent={this.handlePan}\n              onHandlerStateChange={this.handlePan}\n              simultaneousHandlers={this.props.simultaneousHandlers}\n            >\n              <Animated.View>\n                <TapGestureHandler\n                  ref={this.tapRef}\n                  enabled={\n                    this.props.enabledGestureInteraction &&\n                    this.props.enabledContentGestureInteraction &&\n                    this.props.enabledContentTapInteraction\n                  }\n                  onHandlerStateChange={this.handleTap}\n                  simultaneousHandlers={this.props.simultaneousHandlers}\n                >\n                  <Animated.View\n                    style={{\n                      width: '100%',\n                      transform: [{ translateY: this.Y as any }],\n                    }}\n                    onLayout={this.handleLayoutContent}\n                  >\n                    {this.props.renderContent && this.props.renderContent()}\n                  </Animated.View>\n                </TapGestureHandler>\n              </Animated.View>\n            </PanGestureHandler>\n            <Animated.Code\n              exec={onChange(\n                this.tapState,\n                cond(\n                  eq(this.tapState, GestureState.BEGAN),\n                  stopClock(this.decayClock)\n                )\n              )}\n            />\n            {this.props.callbackNode && (\n              <Animated.Code\n                exec={onChange(\n                  this.translateMaster,\n                  set(\n                    this.props.callbackNode,\n                    divide(\n                      this.translateMaster,\n                      this.state.snapPoints[this.state.snapPoints.length - 1]\n                    )\n                  )\n                )}\n              />\n            )}\n            {(this.props.onOpenStart || this.props.onCloseEnd) && (\n              <Animated.Code\n                exec={onChange(this.translateMaster, [\n                  cond(\n                    and(\n                      lessOrEq(\n                        divide(\n                          this.translateMaster,\n                          this.state.snapPoints[\n                            this.state.snapPoints.length - 1\n                          ]\n                        ),\n                        1 -\n                          (this.props.callbackThreshold\n                            ? this.props.callbackThreshold\n                            : 0.01)\n                      ),\n                      neq(this.onOpenStartValue, 1)\n                    ),\n                    [\n                      call([], () => {\n                        if (this.props.onOpenStart) this.props.onOpenStart()\n                      }),\n                      set(this.onOpenStartValue, 1),\n                      cond(\n                        defined(this.onCloseEndValue),\n                        set(this.onCloseEndValue, 0)\n                      ),\n                    ]\n                  ),\n                ])}\n              />\n            )}\n            {(this.props.onOpenEnd || this.props.onCloseStart) && (\n              <Animated.Code\n                exec={onChange(this.translateMaster, [\n                  cond(\n                    and(\n                      lessOrEq(\n                        divide(\n                          this.translateMaster,\n                          this.state.snapPoints[\n                            this.state.snapPoints.length - 1\n                          ]\n                        ),\n                        this.props.callbackThreshold\n                          ? this.props.callbackThreshold\n                          : 0.01\n                      ),\n                      neq(this.onOpenEndValue, 1)\n                    ),\n                    [\n                      call([], () => {\n                        if (this.props.onOpenEnd) this.props.onOpenEnd()\n                      }),\n                      set(this.onOpenEndValue, 1),\n                      cond(\n                        defined(this.onCloseStartValue),\n                        set(this.onCloseStartValue, 0)\n                      ),\n                    ]\n                  ),\n                ])}\n              />\n            )}\n            {(this.props.onCloseStart || this.props.onOpenEnd) && (\n              <Animated.Code\n                exec={onChange(this.translateMaster, [\n                  cond(\n                    and(\n                      greaterOrEq(\n                        divide(\n                          this.translateMaster,\n                          this.state.snapPoints[\n                            this.state.snapPoints.length - 1\n                          ]\n                        ),\n                        this.props.callbackThreshold\n                          ? this.props.callbackThreshold\n                          : 0.01\n                      ),\n                      neq(this.onCloseStartValue, 1)\n                    ),\n                    [\n                      call([], () => {\n                        if (this.props.onCloseStart) this.props.onCloseStart()\n                      }),\n                      set(this.onCloseStartValue, 1),\n                      cond(\n                        defined(this.onCloseStartValue),\n                        set(this.onOpenEndValue, 0)\n                      ),\n                    ]\n                  ),\n                ])}\n              />\n            )}\n            {(this.props.onCloseEnd || this.props.onOpenStart) && (\n              <Animated.Code\n                exec={onChange(this.translateMaster, [\n                  cond(\n                    and(\n                      greaterOrEq(\n                        divide(\n                          this.translateMaster,\n                          this.state.snapPoints[\n                            this.state.snapPoints.length - 1\n                          ]\n                        ),\n                        1 -\n                          (this.props.callbackThreshold\n                            ? this.props.callbackThreshold\n                            : 0.01)\n                      ),\n                      neq(this.onCloseEndValue, 1)\n                    ),\n                    [\n                      call([], () => {\n                        if (this.props.onCloseEnd) this.props.onCloseEnd()\n                      }),\n                      set(this.onCloseEndValue, 1),\n                      cond(\n                        defined(this.onOpenStartValue),\n                        set(this.onOpenStartValue, 0)\n                      ),\n                      cond(\n                        defined(this.onOpenEndValue),\n                        set(this.onOpenEndValue, 0)\n                      ),\n                    ]\n                  ),\n                ])}\n              />\n            )}\n            {this.props.contentPosition && (\n              <Animated.Code\n                exec={onChange(\n                  this.Y,\n                  set(this.props.contentPosition, sub(0, this.Y))\n                )}\n              />\n            )}\n            {this.props.headerPosition && (\n              <Animated.Code\n                exec={onChange(\n                  this.translateMaster,\n                  set(this.props.headerPosition, this.translateMaster)\n                )}\n              />\n            )}\n          </View>\n        </Animated.View>\n      </React.Fragment>\n    )\n  }\n}\n"]}